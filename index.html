<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的世界租赁服导入</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .qq-link {
            color: #888;
            text-decoration: none;
            transition: transform 0.3s ease;
            display: inline-block;
            position: relative;
            top: 0px;
        }
        
        .qq-link:hover {
            color: #0066cc;
            transform: scale(1.1);
        }
        
        .qq-icon {
            margin-right: 1.5px;
            vertical-align: 0.55px;
            font-size: 1em;
        }
    </style>
    <style>
        /* 基础样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f7fa;
            color: #4a5568;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        header p {
            font-size: 18px;
            color: #6c757d;
        }
        .gallery-section {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        .gallery-filters {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .filter-btn {
            position: relative;
            padding: 8px 16px;
            background-color: #fff;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            color: #4a5568;
            overflow: hidden;
            z-index: 1;
        
        }

        .filter-btn .btn-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #4299e1;
            border-radius: 20px;
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
            z-index: -1;
        }
        .filter-btn.active .btn-bg {
            transform: scaleX(1);
        }
        .filter-btn.active {
            color: white;
            border-color: #4299e1;
        }
        .gallery-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            transition: transform 0.5s ease;
        }
        .gallery-item {
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        .gallery-item img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
        }
        /* 添加pre-line样式 - 放在这里 */
        .pre-line-text {
            white-space: pre-line;
            line-height: 1.8; /* 增加行高让阅读更舒适 */
        }
        
        /* 单栏模式下的图片样式 */
        .gallery-container.single-column .gallery-item img {
            height: 650px; /* 单栏模式下更大的高度 */
        }
        
        .gallery-item-info {
            padding: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .gallery-item-info h3 {
            font-size: 18px;
            margin-bottom: 5px;
            color: #2d3748 !important; /* 强制显示标题颜色 */
            display: block !important; /* 确保标题显示 */
        }
        .gallery-item-info p {
            font-size: 14px;
            color: #718096;
            margin-top: auto;
        }
        
        /* 详情页模态框 */
        .preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .preview-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: scale(0.9);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
            width: 100%;
            max-width: 1000px;
        }
        .preview-content.loaded {
            transform: scale(1);
            opacity: 1;
        }
        .detail-header {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .detail-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
            color: #2d3748;
        }
        .detail-meta {
            color: #718096;
            font-size: 14px;
        }
        .detail-number {
            background-color: #e2e8f0;
            color: #4a5568;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
        }
        .detail-price {
            color: #4299e1;
            font-size: 18px;
            font-weight: bold;
            margin-top: 5px;
        }
        .detail-body {
            padding: 20px;
            flex-grow: 1;
            overflow-y: auto;
        }
        
        /* 视频容器 */
        .video-container {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 比例 */
            overflow: hidden;
            margin-bottom: 20px;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }
        
        /* 图片轮播 - 优化版本 */
        .image-carousel {
            position: relative;
            margin-bottom: 20px;
            height: 400px; /* 增加高度以更好展示图片 */
            overflow: hidden;
            border-radius: 8px;
            background-color: #f0f0f0;
        }
        .carousel-container {
            display: flex;
            transition: transform 0.5s ease-in-out; /* 平滑过渡 */
            height: 100%;
        }
        .carousel-item {
            min-width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .carousel-item img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* 保持图片完整，不裁剪 */
            transition: opacity 0.3s ease;
        }
        /* 加载中的图片占位符 */
        .carousel-item img.loading {
            opacity: 0.5;
        }
        /* 轮播控制按钮 */
        .carousel-control {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s, transform 0.3s;
            z-index: 10;
        }
        .carousel-control:hover {
            background-color: rgba(0, 0, 0, 0.7);
            transform: translateY(-50%) scale(1.1);
        }
        .carousel-control.prev {
            left: 15px;
        }
        .carousel-control.next {
            right: 15px;
        }
        .carousel-indicators {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 5;
        }
        .carousel-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .carousel-indicator.active {
            background-color: #fff;
            transform: scale(1.3);
        }
        
        /* 详情页图片描述 */
        .detail-description {
            margin-bottom: 20px;
            line-height: 1.8;
        }
        /* 链接样式 */
        .detail-description a {
            color: #4299e1;
            text-decoration: none;
            transition: color 0.3s, text-decoration 0.3s;
        }
        .detail-description a:hover {
            color: #3182ce;
            text-decoration: underline;
        }
        .detail-footer {
            padding: 15px 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .bilibili-link {
            padding: 8px 16px;
            background-color: #4299e1;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .bilibili-link:hover {
            background-color: #3182ce;
        }
        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: rgb(158, 158, 158);
            font-size: 36px;
            cursor: pointer;
            transition: transform 0.2s, opacity 0.3s;
            opacity: 1;
            z-index: 10;
        }
        .close-modal:hover {
            transform: rotate(90deg);
        }
        .close-modal.fade-out {
            animation: fadeOut 0.5s forwards;
        }
        
        /* 无搜索结果提示 */
        .no-results-message {
            text-align: center;
            padding: 40px 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        .no-results-message h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #2d3748;
        }
        .no-results-message p {
            color: #718096;
            margin-bottom: 20px;
        }
        .no-results-message .search-suggestions {
            margin-top: 20px;
        }
        .no-results-message .search-suggestion {
            display: inline-block;
            margin: 5px;
            padding: 8px 15px;
            background-color: #edf2f7;
            border-radius: 20px;
            font-size: 14px;
            color: #4a5568;
        }
        
        /* 功能按钮区域 */
        .toggle-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #fff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            width: 100px;
        }
        .toggle-item {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        .toggle-label {
            position: absolute;
            left: -90px;
            font-weight: bold;
            color: #4a5568;
            display: none; /* 隐藏文字标签 */
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #4299e1;
        }
        input:focus + .toggle-slider {
            box-shadow: 0 0 1px #4299e1;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }
        
        /* 图标样式 */
        .toggle-icon {
            position: absolute;
            width: 20px;
            height: 20px;
            z-index: 8;
            pointer-events: none;
        }
        .toggle-icon-sun {
            left: 35px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='5'%3E%3C/circle%3E%3Cline x1='12' y1='1' x2='12' y2='3'%3E%3C/line%3E%3Cline x1='12' y1='21' x2='12' y2='23'%3E%3C/line%3E%3Cline x1='4.22' y1='4.22' x2='5.64' y2='5.64'%3E%3C/line%3E%3Cline x1='18.36' y1='18.36' x2='19.78' y2='19.78'%3E%3C/line%3E%3Cline x1='1' y1='12' x2='3' y2='12'%3E%3C/line%3E%3Cline x1='21' y1='12' x2='23' y2='12'%3E%3C/line%3E%3Cline x1='4.22' y1='19.78' x2='5.64' y2='18.36'%3E%3C/line%3E%3Cline x1='18.36' y1='5.64' x2='19.78' y2='4.22'%3E%3C/line%3E%3C/svg%3E");
        }
        .toggle-icon-moon {
            left: 15px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z'%3E%3C/path%3E%3C/svg%3E");
        }
        .toggle-icon-one-col {
            left: 15px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='16' rx='2' ry='2'%3E%3C/rect%3E%3C/svg%3E");
        }
        .toggle-icon-two-col {
            left: 35px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='16' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='12' y1='4' x2='12' y2='20'%3E%3C/line%3E%3C/svg%3E");
        }
        
        /* 暗黑模式 */
        body.dark-mode {
            background-color: #1a202c;
            color: #cbd5e0;
        }
        body.dark-mode .gallery-item {
            background-color: #2d3748;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .gallery-item:hover {
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        body.dark-mode .gallery-item-info {
            color: #cbd5e0;
        }
        body.dark-mode .gallery-item-info h3 {
            color: #e2e8f0 !important; /* 暗黑模式下的标题颜色 */
        }
        body.dark-mode .detail-header {
            border-bottom-color: #4a5568;
        }
        body.dark-mode .detail-footer {
            border-top-color: #4a5568;
        }
        body.dark-mode .preview-modal {
            background-color: rgba(0, 0, 0, 0.95);
        }
        body.dark-mode .preview-content {
            background-color: #2d3748;
        }
        body.dark-mode .detail-description {
            color: #cbd5e0;
        }
        body.dark-mode .detail-description a {
            color: #63b3ed;
        }
        body.dark-mode .detail-description a:hover {
            color: #90cdf4;
        }
        body.dark-mode .bilibili-link {
            background-color: #3182ce;
        }
        body.dark-mode .search-input {
            background-color: #2d3748;
            color: #cbd5e0;
            border-color: #4a5568;
        }
        body.dark-mode .search-input:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }
        body.dark-mode .search-btn {
            background-color: #3182ce;
        }
        body.dark-mode .search-btn:hover {
            background-color: #2b6cb0;
        }
        body.dark-mode .filter-btn {
            background-color: #2d3748;
            border-color: #4a5568;
            color: #cbd5e0;
        }
        body.dark-mode .filter-btn.active {
            background-color: #3182ce;
            border-color: #3182ce;
        }
        body.dark-mode .toggle-container {
            background-color: #2d3748;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }
        body.dark-mode .toggle-label {
            color: #cbd5e0;
        }
        body.dark-mode .toggle-icon-moon,
        body.dark-mode .toggle-icon-sun,
        body.dark-mode .toggle-icon-one-col,
        body.dark-mode .toggle-icon-two-col {
            filter: invert(1);
        }
        body.dark-mode .detail-header h2 {
            color: #e2e8f0;
        }
        body.dark-mode .image-carousel {
            background-color: #1a202c;
        }
        
        /* 搜索框设计 */
        .search-form {
            display: flex;
            max-width: 600px;
            width: 100%;
            margin: 0 auto 20px;
        }
        .search-input {
            flex-grow: 1;
            padding: 12px 15px;
            border: 2px solid #4299e1;
            border-radius: 8px 0 0 8px;
            font-size: 16px;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .search-input:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
        }
        .search-btn {
            padding: 12px 20px;
            background-color: #4299e1;
            color: white;
            border: none;
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .search-btn:hover {
            background-color: #3182ce;
        }
        
        /* 动画效果 */
        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.8);
            }
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
           .gallery-filters {
                gap: 8px; 
                padding: 0 10px; 
                align-items: center; 
            }
            .toggle-container {
                bottom: 10px;
                right: 10px;
                width: 90px;
                padding: 10px;
            }
            .toggle-switch {
                width: 50px;
                height: 25px;
            }
            .toggle-slider:before {
                height: 17px;
                width: 17px;
                left: 4px;
                bottom: 4px;
            }
            input:checked + .toggle-slider:before {
                transform: translateX(25px);
            }
            .gallery-container {
                grid-template-columns: repeat(2, 1fr);
            }
            .image-carousel {
                height: 300px;
            }
            .carousel-control {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            /* 单栏模式下的图片高度 */
            .gallery-container.single-column .gallery-item img {
                height: 280px;
            }
        }
        @media (max-width: 480px) {
            .filter-btn {
               padding: 5px 10px; 
               font-size: 15px; 字体
           /*    border-radius: 24px;  保持圆角风格，可适当调整 */
            }
            .gallery-container {
                grid-template-columns: repeat(2, 1fr);
            }
            .close-modal {
                font-size: 30px;
            }
            .image-carousel {
                height: 220px;
            }
            .carousel-control {
                width: 34px;
                height: 34px;
                font-size: 14px;
            }
            /* 单栏模式下的图片高度 */
            .gallery-container.single-column .gallery-item img {
                height: 220px;
            }
        }
        /* 定义一个文本样式 */
        .footer-text {
            position: fixed; /* 固定位置 */
            bottom: 10px;  /*距离底部10像素 */
            left: 50%; /* 距离右侧10像素 */
            transform: translate(-50%, -50%);
            font-size: 14px; /* 字体大小 */
            color: #666; /* 字体颜色 */
            text-align: center;
            margin-top: auto
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>我的世界租赁服导入</h1>
            </p>定制/导入 
        <a href="https://qm.qq.com/q/EPSJuvWsms" class="qq-link">
            <i class="fa-brands fa-qq qq-icon"></i>3095564388
        </a> </p>
        </header>
        
        <section class="search-filter-section">
            <form class="search-form">
                <input type="text" class="search-input" placeholder="搜索作品...">
                <button type="submit" class="search-btn">搜索</button>
            </form>
            
            <div class="gallery-filters">
                <button class="filter-btn active" data-filter="nes">
                    <span class="btn-bg"></span>
                    新品
                </button>
                <button class="filter-btn" data-filter="all">
                    <span class="btn-bg"></span>
                    全部
                </button>
                <button class="filter-btn" data-filter="serve">
                    <span class="btn-bg"></span>
                    开服
                </button>
                <button class="filter-btn" data-filter="command">
                    <span class="btn-bg"></span>
                    指令
                </button>
                <button class="filter-btn" data-filter="build">
                    <span class="btn-bg"></span>
                    建筑
                </button>
                <button class="filter-btn" data-filter="other">
                    <span class="btn-bg"></span>
                    其他
                </button>
            </div>
        </section>
        
        <section class="gallery-section">
            <div class="gallery-container" id="galleryContainer">
                <!-- 图片画廊将通过JavaScript动态生成 -->
            </div>
        </section>
    </div>
    
    <div class="footer-text">导入支持@阿紫工作室</div>
    
    <!-- 建筑详情页模态框 -->
    <div class="preview-modal" id="detailModal">
        <button class="close-modal" id="closeDetail">&times;</button>
        <div class="preview-content">
            <div class="detail-header">
                <div>
                    <h2 id="detailTitle"></h2>
                    <div class="detail-meta" id="detailMeta"></div>
                    <div class="detail-price" id="detailPrice"></div>
                </div>
                <div class="detail-number" id="detailNumber"></div>
            </div>
            <div class="detail-body">
                <div class="image-carousel">
                    <!-- 轮播控制按钮 -->
                    <button class="carousel-control prev" id="prevBtn">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="carousel-control next" id="nextBtn">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                    
                    <div class="carousel-container" id="carouselContainer">
                        <!-- 图片轮播将通过JavaScript动态生成 -->
                    </div>
                    <div class="carousel-indicators" id="carouselIndicators">
                        <!-- 指示器将通过JavaScript动态生成 -->
                    </div>
                </div>
                <div class="video-container">
                    <iframe id="bilibiliIframe" src="" frameborder="0" allowfullscreen></iframe>
                </div>
                <div class="detail-description" id="detailDescription"></div>
            </div>
            <div class="detail-footer">
                <a href="" id="bilibiliLink" class="bilibili-link" target="_blank">在 Bilibili 查看完整视频</a>
            </div>
        </div>
    </div>
    
    <!-- 功能按钮区域 -->
    <div class="toggle-container">
        <div class="toggle-item">
            <span class="toggle-label">黑夜模式</span>
            <label class="toggle-switch">
                <input type="checkbox" id="themeToggle">
                <span class="toggle-slider"></span>
            </label>
            <div class="toggle-icon toggle-icon-sun"></div>
            <div class="toggle-icon toggle-icon-moon"></div>
        </div>
        <div class="toggle-item">
            <span class="toggle-label">1/2 列显示</span>
            <label class="toggle-switch">
                <input type="checkbox" id="viewModeToggle">
                <span class="toggle-slider"></span>
            </label>
            <div class="toggle-icon toggle-icon-two-col"></div>
            <div class="toggle-icon toggle-icon-one-col"></div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 建筑项目数据
            const buildingProjects = [
                {
                    id: 1,
                    title: "占位",
                    description: "文本",
                    images: [
                        "images/developing.jpg",
                        "images/reward.png",
                        "https://via.placeholder.com/800x600?text=Castle+3"
                    ],
                    category: "build",
                    subcategory: "", 
                    author: "原创",
                    date: "2023-10-15",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1jt421c7yN",
                    price: "20 CNY"
                },
                {
                    id: 2,
                    title: "现代别墅",
                    description: "这栋别墅采用现代简约风格，大面积玻璃窗和开放式布局。内部有4间卧室、3个浴室、一个宽敞的客厅和一个现代化的厨房。后院设有游泳池和休闲区。",
                    images: [
                        "https://via.placeholder.com/800x600?text=Modern+House+1",
                        "https://via.placeholder.com/800x600?text=Modern+House+2",
                        "https://via.placeholder.com/800x600?text=Modern+House+3"
                    ],
                    category: "build",
                    subcategory: "build", // 建筑
                    author: "原创",
                    date: "2023-11-02",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1454y187Er",
                    price: "800 钻石"
                },
                {
                    id: 3,
                    title: "古代神庙",
                    description: "这座神庙参考了古埃及和玛雅文明的建筑风格，拥有宏伟的阶梯式金字塔结构和精美的浮雕装饰。内部设有神殿和祭祀区域。",
                    images: [
                        "https://via.placeholder.com/800x600?text=Ancient+Temple+1",
                        "https://via.placeholder.com/800x600?text=Ancient+Temple+2",
                        "https://via.placeholder.com/800x600?text=Ancient+Temple+3"
                    ],
                    category: "build",
                    subcategory: "build", // 建筑
                    author: "原创",
                    date: "2023-09-28",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1454y187Er",
                    price: "950 钻石"
                },
                {
                    id: 4,
                    title: "幻想城堡",
                    description: "这座城堡融合了哥特式和巴洛克式建筑元素，拥有尖塔、彩色玻璃窗和华丽的装饰。内部有宏伟的大厅、豪华的卧室和秘密通道。",
                    images: [
                        "https://via.placeholder.com/800x600?text=Fantasy+Castle+1",
                        "https://via.placeholder.com/800x600?text=Fantasy+Castle+2",
                        "https://via.placeholder.com/800x600?text=Fantasy+Castle+3"
                    ],
                    category: "build",
                    subcategory: "build", // 建筑
                    author: "原创",
                    date: "2023-10-20",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1454y187Er",
                    price: "1350 钻石"
                },
                {
                    id: 5,
                    title: "租赁服",
                    description: "",
                    images: [
                        "https://via.placeholder.com/800x600?text=Office+Building+1",
                        "https://via.placeholder.com/800x600?text=Office+Building+2",
                        "https://via.placeholder.com/800x600?text=Office+Building+3"
                    ],
                    category: "",
                    subcategory: "", // 新品
                    author: "原创",
                    date: "2023-11-10",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1454y187Er",
                    price: "1100 钻石"
                },
                {
                    id: 6,
                    title: "血钻擂台-简易斗赏擂台赛",
                    description: "「血钻擂台」——“以血为注，钻为命”\n20钻门槛象征“押上全部身家”，赢家通吃10钻，输家血本无归\n\n玩法\n准备场地内同时存在两名玩家且无其他人决斗时，玩家可点击按钮，两名玩家提交参赛费12颗钻石进入对决,对局结束后，参与玩家将被传送到准备房间，胜利玩家获得20钻石，对局内退出将自动判负，另外玩家获得20钻石，退出的玩家重连后会自动传送到准备房间内\n\n其他\n可选择开启对局内禁用菜单的功能(菜单计分板为\"menu\"、\"菜单\"和\"雪球菜单\"自动禁用，其他需手动更改),\n包含建筑   计分板自动配置   无结构配置",
                    images: [
                        "images\\diamond_pvp_1.jpg",
                        "https://via.placeholder.com/800x600?text=Underground+Fortress+2",
                        "https://via.placeholder.com/800x600?text=Underground+Fortress+3"
                    ],
                    category: "command",
                    subcategory: "nes", // 新品
                    author: "原创",
                    date: "2025-7-27",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1454y187Er",
                    price: "25 CNY (第二件半价)"
                },
                {
                    id: 7,
                    title: "悦灵意见箱",
                    description: "用于收集玩家反馈和建议的指令方块系统，设计新颖，交互反馈幽默，自动检测玩家提交内容，非书和羽毛以及空的书和羽毛将不会储存记录。",
                    images: [
                        "images\\allay_box_1.jpg",
                        "images\\allay_box_2.jpg",
                        "images\\allay_box_3.jpg"
                    ],
                    category: "command",
                    subcategory: "nes", // 指令
                    author: "原创",
                    date: "2025-7-26",
                    bilibiliUrl: "https://www.bilibili.com/video/BV1mw8tzSEUM",
                    price: "25 CNY (第二件半价)"
                },
                {
                    id: 8,
                    title: "租赁服刷赞",
                    description: "600❤️  10r\n1w❤️  100r\n3w❤️  250r\n10w❤️  1250r\n20w❤️  2000r",
                    images: [
                        "images\\like.jpg",
                        "https://via.placeholder.com/800x600?text=Command+Suggestion+Box+2",
                        "https://via.placeholder.com/800x600?text=Command+Suggestion+Box+3"
                    ],
                    category: "other",
                    subcategory: "nes", // 新品
                    author: "阿紫工作室",
                    date: "2025-7-25",
                    bilibiliUrl: "null",
                    price: "见详情"
                },
                {
                    id: 9,
                    title: "租赁服推荐",
                    description: "交流群<a href='https://qm.qq.com/q/xa26XzMEbC' class='qq-group-link' target='_blank'>\
            <i class='fa-brands fa-qq qq-icon'></i> 981134637</a><br>更多视频<br>\
        <a href='https://b23.tv/3ZDWgj0' target='_blank'>网易我的世界贝爷生存租赁服招新宣传</a><br>\
        <a href='https://b23.tv/J212qPa' target='_blank'>网易我的世界租赁服仿贝爷生存-地底世界更新</a>",
                    images: [
                        "images\\mite.jpg",
                        "https://b23.tv/3ZDWgj0",
                        "https://b23.tv/s6xJ2Ox"
                    ],
                    category: "other",
                    subcategory: "nes", // 新品
                    author: "原创",
                    date: "2025-7-25",
                    bilibiliUrl: "https://www.bilibili.com/video/BV17HHueKERV",
                    price: "免费"
                }
            ];
            
            // 当前视图模式 - 默认为每行显示2个建筑
            let currentViewMode = 'two';
            let currentCarouselIndex = 0;
            let currentProjectId = null;
            
            // 渲染画廊
            function renderGallery(projects) {
                const galleryContainer = document.getElementById('galleryContainer');
                
                galleryContainer.innerHTML = '';
                
                if (projects.length === 0) {
                    const noResults = document.createElement('div');
                    noResults.className = 'no-results-message';
                    noResults.innerHTML = `
                        <h3>没有找到相关结果</h3>
                        <p>尝试使用其他关键词搜索<br>或联系 
        <a href="https://qm.qq.com/q/EPSJuvWsms" class="qq-link">
            <i class="fa-brands fa-qq qq-icon"></i>3095564388
        </a> 定制
    </p>
                    `;
                    galleryContainer.appendChild(noResults);
                    return;
                }
                
                projects.forEach(project => {
                    const galleryItem = document.createElement('div');
                    galleryItem.className = 'gallery-item';
                    galleryItem.dataset.id = project.id;
                    
                    // 确保标题被正确渲染
                    galleryItem.innerHTML = `
                        <img src="${project.images[0]}" alt="${project.title}">
                        <div class="gallery-item-info">
                            <h3>${project.title}</h3>
                            <p>${project.author} · ${project.date}</p>
                        </div>
                    `;
                    
                    galleryItem.addEventListener('click', () => {
                        showDetail(project);
                    });
                    
                    galleryContainer.appendChild(galleryItem);
                });
                
            //    updateViewMode();
            }
            
            // 显示建筑详情
            function showDetail(project) {
                const modal = document.getElementById('detailModal');
                const content = document.querySelector('.preview-content');
                const title = document.getElementById('detailTitle');
                const meta = document.getElementById('detailMeta');
                const description = document.getElementById('detailDescription');
                const bilibiliLink = document.getElementById('bilibiliLink');
                const bilibiliIframe = document.getElementById('bilibiliIframe');
                const carouselContainer = document.getElementById('carouselContainer');
                const carouselIndicators = document.getElementById('carouselIndicators');
                const price = document.getElementById('detailPrice');
                const number = document.getElementById('detailNumber');
                
                // 设置基本信息
                title.textContent = project.title;
                meta.textContent = `${project.author} · ${project.date}`;
                // 使用innerHTML而不是textContent以保留链接格式
                description.innerHTML = project.description;
                description.classList.add('pre-line-text');
                bilibiliLink.href = project.bilibiliUrl;
                price.textContent = project.price;
                number.textContent = `#${project.id}`;
                
                // 修复B站视频嵌入问题
                const bvMatch = project.bilibiliUrl.match(/BV[\w]+/);
                if (bvMatch && bvMatch[0]) {
                    const bvId = bvMatch[0];
                    bilibiliIframe.src = `https://player.bilibili.com/player.html?bvid=${bvId}&page=1`;
                    document.querySelector('.video-container').style.display = 'block';
                } else {
                    document.querySelector('.video-container').style.display = 'none';
                }
                
                // 清空并重新填充轮播图片
                carouselContainer.innerHTML = '';
                carouselIndicators.innerHTML = '';
                
                project.images.forEach((image, index) => {
                    const carouselItem = document.createElement('div');
                    carouselItem.className = 'carousel-item';
                    
                    // 创建图片元素并添加加载效果
                    const img = document.createElement('img');
                    img.src = image;
                    img.alt = `${project.title} - ${index + 1}`;
                    img.classList.add('loading');
                    
                    // 图片加载完成后移除加载状态
                    img.onload = function() {
                        this.classList.remove('loading');
                    };
                    
                    carouselItem.appendChild(img);
                    carouselContainer.appendChild(carouselItem);
                    
                    // 添加指示器
                    const indicator = document.createElement('div');
                    indicator.className = index === 0 ? 'carousel-indicator active' : 'carousel-indicator';
                    indicator.dataset.index = index;
                    indicator.addEventListener('click', () => {
                        currentCarouselIndex = index;
                        updateCarousel(project);
                    });
                    carouselIndicators.appendChild(indicator);
                });
                
                // 设置初始当前索引
                currentCarouselIndex = 0;
                currentProjectId = project.id;
                
                // 显示模态框并触发动画
                modal.style.display = 'flex';
                content.classList.remove('loaded');
                void content.offsetWidth; 
                content.classList.add('loaded');
                
                // 滑动时更新轮播
                let startX, endX;
                carouselContainer.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                });
                
                carouselContainer.addEventListener('touchend', (e) => {
                    endX = e.changedTouches[0].clientX;
                    if (startX - endX > 50 && currentCarouselIndex < project.images.length - 1) {
                        // 向右滑动，显示下一张
                        currentCarouselIndex++;
                        updateCarousel(project);
                    } else if (endX - startX > 50 && currentCarouselIndex > 0) {
                        // 向左滑动，显示上一张
                        currentCarouselIndex--;
                        updateCarousel(project);
                    }
                });
                
                // 初始化轮播
                updateCarousel(project);
                
                // 添加左右按钮点击事件
                document.getElementById('prevBtn').onclick = () => {
                    if (currentCarouselIndex > 0) {
                        currentCarouselIndex--;
                        updateCarousel(project);
                    }
                };
                
                document.getElementById('nextBtn').onclick = () => {
                    if (currentCarouselIndex < project.images.length - 1) {
                        currentCarouselIndex++;
                        updateCarousel(project);
                    }
                };
            }
            
            
            // 更新轮播状态 - 修复版本
            function updateCarousel(project) {
                const carouselContainer = document.getElementById('carouselContainer');
                const indicators = document.querySelectorAll('.carousel-indicator');
                
                // 移动轮播容器
                carouselContainer.style.transform = `translateX(-${currentCarouselIndex * 100}%)`;
                
                // 更新指示器状态
                indicators.forEach((indicator, index) => {
                    if (index === currentCarouselIndex) {
                        indicator.classList.add('active');
                    } else {
                        indicator.classList.remove('active');
                    }
                });
            }
            
            // 关闭详情页
            function closeDetail() {
                const modal = document.getElementById('detailModal');
                const content = document.querySelector('.preview-content');
                const bilibiliIframe = document.getElementById('bilibiliIframe');
                
                content.style.animation = 'fadeOut 0.5s forwards';
                
                setTimeout(() => {
                    modal.style.display = 'none';
                    content.style.animation = '';
                    bilibiliIframe.src = '';
                }, 500);
            }
            
            // 筛选建筑
            function filterBuildings(category) {
                if (category === 'all') {
                    renderGallery(buildingProjects);
                } else {
                    // 如果是子分类，需要先找到对应的主分类
                    let filteredProjects;
                    if (category === 'nes') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'nes');
                    } else if (category === 'lottery') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'lottery');
                    } else if (category === 'boss') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'boss');
                    } else if (category === 'health') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'health');
                    } else if (category === 'damage') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'damage');
                    } else if (category === 'portal') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'portal');
                    } else if (category === 'save') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'save');
                    } else if (category === 'weather') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'weather');
                    } else if (category === 'event') {
                        filteredProjects = buildingProjects.filter(project => project.subcategory === 'event');
                    } else {
                        filteredProjects = buildingProjects.filter(project => project.category === category);
                    }
                    renderGallery(filteredProjects);
                }
            }
            
            // 搜索框功能
            let searchTerm = '';
            const searchForm = document.querySelector('.search-form');
            const searchInput = document.querySelector('.search-input');
            
            searchForm.addEventListener('submit', function(e) {
                e.preventDefault();
                searchTerm = searchInput.value.trim().toLowerCase();
                
                if (searchTerm === '') {
                    // 搜索为空时
                    filterBuildings('all');
                    return;
                }
                
                const searchResults = buildingProjects.filter(project => 
                    project.title.toLowerCase().includes(searchTerm) || 
                    project.description.toLowerCase().includes(searchTerm) ||
                    project.author.toLowerCase().includes(searchTerm)
                );
                
                renderGallery(searchResults);
            });
            
            // 初始化页面 - 确保默认显示新品
            filterBuildings('nes');
            
            // 模态框关闭事件
            document.getElementById('closeDetail').addEventListener('click', closeDetail);
            
            // 点击模态框外部关闭
            document.getElementById('detailModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeDetail();
                }
            });
            
            // 主题切换功能
            const themeToggle = document.getElementById('themeToggle');
            
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                themeToggle.checked = true;
            }
            
            themeToggle.addEventListener('change', function() {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('darkMode', this.checked);
            });
            
            // 视图模式切换功能
            const viewModeToggle = document.getElementById('viewModeToggle');
            
            if (localStorage.getItem('viewMode') === 'one') {
                currentViewMode = 'one';
                viewModeToggle.checked = true;
                updateViewMode();
            }
            
            viewModeToggle.addEventListener('change', function() {
                if (this.checked) {
                    currentViewMode = 'one';
                } else {
                    currentViewMode = 'two';
                }
                localStorage.setItem('viewMode', currentViewMode);
                updateViewMode();
            });
            
            // 更新视图模式
            function updateViewMode() {
                const galleryContainer = document.getElementById('galleryContainer');
                
                if (currentViewMode === 'one') {
                    galleryContainer.style.gridTemplateColumns = '1fr';
                    galleryContainer.classList.add('single-column');
                } else {
                    galleryContainer.style.gridTemplateColumns = '';
                    galleryContainer.classList.remove('single-column');
                }
            }
            
            // 分类按钮事件
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    const filter = this.dataset.filter;
                    filterBuildings(filter);
                });
            });
            
            // 切换显示的图标
            function updateToggleIcons() {
                const darkModeToggle = document.getElementById('themeToggle');
                const viewModeToggle = document.getElementById('viewModeToggle');
                
                // 黑夜模式图标
                if (darkModeToggle.checked) {
                    document.querySelector('.toggle-icon-sun').style.display = 'none';
                    document.querySelector('.toggle-icon-moon').style.display = 'block';
                } else {
                    document.querySelector('.toggle-icon-moon').style.display = 'none';
                    document.querySelector('.toggle-icon-sun').style.display = 'block';
                }
                
                // 列显示模式图标
                if (viewModeToggle.checked) {
                    document.querySelector('.toggle-icon-two-col').style.display = 'none';
                    document.querySelector('.toggle-icon-one-col').style.display = 'block';
                } else {
                    document.querySelector('.toggle-icon-one-col').style.display = 'none';
                    document.querySelector('.toggle-icon-two-col').style.display = 'block';
                }
            }
            
            // 初始化图标显示
            updateToggleIcons();
            
            // 监听开关变化，更新图标显示
            document.getElementById('themeToggle').addEventListener('change', updateToggleIcons);
            document.getElementById('viewModeToggle').addEventListener('change', updateToggleIcons);
        });
    </script>
</body>
</html>
